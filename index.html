<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>H2 TechService ‚Äì Rechnung</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
@media print {
  .no-print { display: none !important; }
}
textarea.desc {
  min-height: 100px;
  resize: vertical;
}
input.qty {
  width: 80px;
}
</style>
</head>

<body class="bg-gray-100 p-4">
<div id="invoice" class="bg-white p-6 max-w-3xl mx-auto shadow">

<h1 class="text-2xl font-bold text-center mb-4">Rechnung</h1>

<div class="text-sm mb-4">
<b>H2 TechService</b><br>
Inhaber: Osman Tuncer<br>
Suntal Str. 48, 31552 Rodenberg<br>
Tel: +49 176 66658777<br>
E-Mail: 74star@gmail.com<br>
IBAN: LT83 2500 9251 8928 659<br>
BIC: REVOLT21
</div>

<hr class="mb-4">

<div class="grid grid-cols-2 gap-2 mb-4">
<div>
Kunde:<br>
<input id="customer" class="border p-1 w-full">
</div>
<div>
Rechnungsnr:<br>
<span id="invNr"></span>
</div>
<div>
Datum:<br>
<span id="date"></span>
</div>
<div>
F√§llig:<br>
<span id="due"></span>
</div>
</div>

<table class="w-full border text-sm mb-4">
<thead class="bg-gray-200">
<tr>
<th class="border p-1">Beschreibung</th>
<th class="border p-1">Menge</th>
<th class="border p-1">Preis ‚Ç¨</th>
<th class="border p-1">Gesamt ‚Ç¨</th>
</tr>
</thead>
<tbody>
<tr>
<td class="border p-1">
<textarea class="desc border w-full"></textarea>
</td>
<td class="border p-1 text-center">
<input type="number" class="qty border" value="1" min="1" max="10000" onchange="calc()">
</td>
<td class="border p-1 text-center">
<input type="number" class="price border" value="0" onchange="calc()">
</td>
<td class="border p-1 text-right">
<span class="lineTotal">0</span>
</td>
</tr>
</tbody>
</table>

<div class="text-right text-sm">
Zwischensumme: <span id="sub">0</span> ‚Ç¨<br>
MwSt 19 %: <span id="vat">0</span> ‚Ç¨<br>
<b>Gesamt: <span id="total">0</span> ‚Ç¨</b>
</div>

<div class="no-print mt-4 flex gap-2">
<button onclick="saveInvoice()" class="border px-3 py-1">üíæ Speichern</button>
<button onclick="clearInvoice()" class="border px-3 py-1">üóë L√∂schen</button>
<button onclick="makePDF()" class="border px-3 py-1">üìÑ PDF</button>
<button onclick="shareMail()" class="border px-3 py-1">‚úâÔ∏è Email</button>
<button onclick="shareWA()" class="border px-3 py-1">üì± WhatsApp</button>
</div>

</div>

<script>
const nr = "H2-" + Date.now();
document.getElementById("invNr").innerText = nr;

const d = new Date();
document.getElementById("date").innerText = d.toLocaleDateString("de-DE");
d.setDate(d.getDate()+14);
document.getElementById("due").innerText = d.toLocaleDateString("de-DE");

function calc(){
let qty = document.querySelector(".qty").value;
let price = document.querySelector(".price").value;
let sum = qty * price;
document.querySelector(".lineTotal").innerText = sum.toFixed(2);
let vat = sum * 0.19;
document.getElementById("sub").innerText = sum.toFixed(2);
document.getElementById("vat").innerText = vat.toFixed(2);
document.getElementById("total").innerText = (sum+vat).toFixed(2);
}

function makePDF(){
html2pdf().from(document.getElementById("invoice")).save(nr+".pdf");
}

function saveInvoice(){
localStorage.setItem(nr, document.getElementById("invoice").innerHTML);
alert("Gespeichert");
}

function clearInvoice(){
if(confirm("Alles l√∂schen?")) location.reload();
}

function shareMail(){
location.href="mailto:?subject=Rechnung "+nr;
}
function shareWA(){
window.open("https://wa.me/?text=Rechnung "+nr);
}

calc();
</script>

</body>
</html>
